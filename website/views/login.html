<!DOCTYPE html>
<html>
<head>
    <title>1self - Live smarter</title>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1">
    <meta name="description" content="1self signup"/>
    <meta name="keywords" content="1self Quantified Dev Development QuantifiedSelf Quantified Self"/>
    <meta name="author" content="1self"/>
    <link rel="shortcut icon" href="/img/fav.ico">
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/signup.css" rel="stylesheet">
    <link href="/css/animate.css" rel="stylesheet">
    <link href="/fonts/font-awesome.css" rel="stylesheet">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/top-bar.css">
    <script src="js/jquery.js"></script>
    <script src="js/jquery-ui-v1.10.3.js"></script>

    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-54838479-1', 'auto');
        ga('send', 'pageview');
    </script>

    <script>
        // Always redirect to 1self.co from quantifieddev domain
        if (window.location.href.match(/staging.quantifieddev.org/) !== null) {
            // For staging
            window.location.replace("https://app-staging.1self.co" + window.location.search);
        } else if (window.location.href.match(/quantifieddev.org/) !== null) {
            // For production
            window.location.replace("https://app.1self.co" + window.location.search);
        }

        function login() {
            if (inIframe()) {
                window.open("/auth/github", "_blank");
            } else {
                window.location.href = "/auth/github";
            }
        }

        function inIframe() {
            try {
                return window.self !== window.top;
            } catch (e) {
                return true;
            }
        }

    </script>

</head>
<body class="animated fadeInDown">
<div class="top-bar">
    <a href="http://www.1self.co" target="_blank" class="logo"><img src="/img/logo.png"/></a>
</div>
<div class="jumbotron white-background">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                <h2 class="header-text">Login</h2>
            </div>
        </div>
        <form class="form-horizontal well signup-form" id="loginform" name="username-form" action="/login" method="post" >
            <input type="hidden" id="service" name="service">
            <div class="row margin-top-five">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 ">
                    <button class="btn btn-lg signup-button authservice-button authinput githubbutton" type="submit" onclick="setService('github')">
                    <div class="authserviceicon"><i class="fa fa-github-square"> </i></div>
                    <div class="authservicetext">Login with GitHub</div></button>

                </div>
            </div>
            <div class="row margin-top-five">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <button class="btn btn-lg signup-button authservice-button authinput facebookbutton" type="submit" onclick="setService('facebook')">
                    <div class="authserviceicon"><i class="fa fa-facebook-square"></i></div>
                    <div class="authservicetext">Login with Facebook</div></button>
                </div>
            </div>
        </form>
        <hr id="joindivider">
        <div class="row login-link-container">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <span>Don't have an account?</span>
                <a id="signup_with_github">Join 1self</a>
            </div>
        </div>
    </div>
</div>


<script>

    $(document).ready(function () {
        $("#signup_with_github").click(function () {
            ga('send', 'event', 'login switch to signup', 'signup_with_github');
            window.location.href = "/signup";
        })
        $("#login_with_github").click(function () {
            ga('send', 'event', 'login', 'login_with_github');
            login();
        })
    });

    var service = '';

    $( "#loginform" ).submit(function( event ) {
        $('#service').val(service)
    });

    var setService = function(submitClicked){
        service = submitClicked;
    }

</script>

</body>
</html>
